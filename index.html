<html>
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.js"></script>
<script src="mandelbrot.js"></script>
<canvas></canvas>
<canvas style="display:none"></canvas>
<pre style="display:none" id="vertex">
	attribute vec2 position; //the position of the point
	varying vec2 vPosition;
	void main(void) { //pre-built function
		vPosition = position;
		gl_Position = vec4(position, 0., 1.); //0. is the z, and 1 is w		
	}
</pre>
<pre style="display:none" id="fragment">
	precision highp float;

	varying vec2 vPosition;
	uniform sampler2D sampler2d;
	uniform float idx; 
	
	void main(void) {
		float x = vPosition.x * 2.0;
		float y = vPosition.y * 2.0;
				
		float tx = (vPosition.x + 1.0) / 2.0;
		float ty = (vPosition.y + 1.0) / 2.0; 
		
		float scale = 6.0; 
		vec4 zn = texture2D(sampler2d, vec2(tx,ty)) * scale - (scale / 2.0);

		if(idx == 0.0) {
			zn = vec4(0.0, 0.0, 0.0, 0.0);
		}
		vec2 zn1 = vec2(zn.x * zn.x - zn.y * zn.y, 2.0 * zn.x * zn.y) + vec2(x, abs(y)); 
		float b = 1.0;
			
		if((abs(zn1.x) < 2.0 && abs(zn1.y) < 2.0 && (zn.z < 0.5)) || idx < 2.0) {
			b = 0.0; 			
			zn1 = zn1.xy / scale + 0.5;
		} else {
			//zn1 = vec2(0.0, 0.0);
			zn1 = zn.xy; 
		}		
		gl_FragColor = vec4(zn1, b, 1.0);			
	}
</pre>
</head>
</html>